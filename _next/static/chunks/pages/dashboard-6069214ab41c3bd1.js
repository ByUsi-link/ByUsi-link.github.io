(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(9379)}])},9379:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return Dashboard}});var n=r(5893),i=r(7294),t=r(5616),a=r(2293),l=r(155),o=r(5861),c=r(9417),d=r(3953),x=r(6886),h=r(6242),j=r(4267),u=r(9661),Z=r(7918),m=r(760),b=r(44),v=r(1163),y=r(7955),f=r(1519),p=r(5398),g=r(4918);function Profile(e){let{user:s}=e,formatDate=e=>e?new Date(e).toLocaleString("zh-CN"):"未知";return(0,n.jsxs)(x.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(x.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(h.Z,{elevation:1,children:(0,n.jsxs)(j.Z,{children:[(0,n.jsxs)(o.Z,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(p.Z,{sx:{mr:1}}),"基本信息"]}),(0,n.jsx)(f.Z,{sx:{mb:2}}),(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"用户名"}),(0,n.jsx)(o.Z,{variant:"body1",children:s.username})]}),(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"邮箱地址"}),(0,n.jsxs)(t.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(o.Z,{variant:"body1",children:s.email}),(0,n.jsx)(Z.Z,{label:s.emailVerified?"已验证":"未验证",color:s.emailVerified?"success":"warning",size:"small"})]})]}),s.uid&&(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"用户ID"}),(0,n.jsx)(o.Z,{variant:"body1",children:s.uid})]})]})})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,md:6,children:(0,n.jsx)(h.Z,{elevation:1,children:(0,n.jsxs)(j.Z,{children:[(0,n.jsxs)(o.Z,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(g.Z,{sx:{mr:1}}),"账户信息"]}),(0,n.jsx)(f.Z,{sx:{mb:2}}),(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"注册时间"}),(0,n.jsx)(o.Z,{variant:"body1",children:formatDate(s.registrationTime)})]}),(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"最后登录"}),(0,n.jsx)(o.Z,{variant:"body1",children:s.lastLoginTime?formatDate(s.lastLoginTime):"首次登录"})]}),(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"账户状态"}),(0,n.jsx)(Z.Z,{label:"active"===s.status?"活跃":s.status,color:"active"===s.status?"success":"default",size:"small"})]}),s.userGroup&&(0,n.jsxs)(t.Z,{sx:{mb:2},children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"用户组"}),(0,n.jsx)(Z.Z,{label:s.userGroup,color:"admin"===s.userGroup?"primary":"default",size:"small"})]})]})})})]})}var w=r(5521);function TabPanel(e){let{children:s,value:r,index:i,...a}=e;return(0,n.jsx)("div",{role:"tabpanel",hidden:r!==i,id:"dashboard-tabpanel-".concat(i),"aria-labelledby":"dashboard-tab-".concat(i),...a,children:r===i&&(0,n.jsx)(t.Z,{sx:{p:3},children:s})})}function Dashboard(){var e;let[s,r]=(0,i.useState)(0),[f,p]=(0,i.useState)(null),{user:g,isAuthenticated:P,logout:_}=(0,y.a)(),B=(0,v.useRouter)();(0,i.useEffect)(()=>{if(!P){B.push("/login");return}fetchUserData()},[P,B]);let fetchUserData=async()=>{try{let e=await fetch("/api/user",{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){let s=await e.json();p(s.data)}}catch(e){console.error("获取用户数据失败:",e)}};return P&&g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.Z,{title:"用户控制台",description:"管理您的 ByUsi 账户系统设置和个人信息",keywords:"控制台,用户面板,账户设置,个人信息,ByUsi"}),(0,n.jsxs)(t.Z,{sx:{flexGrow:1},children:[(0,n.jsx)(a.Z,{position:"static",elevation:0,children:(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(o.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"ByUsi Account System"}),(0,n.jsx)(c.Z,{color:"inherit",onClick:()=>{_(),B.push("/")},children:"退出登录"})]})}),(0,n.jsx)(d.Z,{maxWidth:"lg",sx:{mt:4},children:(0,n.jsxs)(x.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{elevation:2,children:(0,n.jsxs)(j.Z,{sx:{p:4},children:[(0,n.jsxs)(t.Z,{display:"flex",alignItems:"center",mb:3,children:[(0,n.jsx)(u.Z,{sx:{width:64,height:64,mr:3},children:null===(e=g.username)||void 0===e?void 0:e.charAt(0).toUpperCase()}),(0,n.jsxs)(t.Z,{children:[(0,n.jsxs)(o.Z,{variant:"h4",gutterBottom:!0,children:["欢迎回来，",g.username,"！"]}),(0,n.jsxs)(t.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(o.Z,{variant:"body1",color:"text.secondary",children:g.email}),(0,n.jsx)(Z.Z,{label:g.emailVerified?"已验证":"未验证",color:g.emailVerified?"success":"warning",size:"small"})]})]})]}),(0,n.jsxs)(m.Z,{value:s,onChange:(e,s)=>r(s),sx:{borderBottom:1,borderColor:"divider"},children:[(0,n.jsx)(b.Z,{label:"个人信息"}),(0,n.jsx)(b.Z,{label:"账户安全"}),(0,n.jsx)(b.Z,{label:"OAuth绑定"})]}),(0,n.jsx)(TabPanel,{value:s,index:0,children:(0,n.jsx)(Profile,{user:f||g})}),(0,n.jsxs)(TabPanel,{value:s,index:1,children:[(0,n.jsx)(o.Z,{variant:"h6",gutterBottom:!0,children:"账户安全"}),(0,n.jsx)(o.Z,{color:"text.secondary",children:"安全设置功能开发中..."})]}),(0,n.jsxs)(TabPanel,{value:s,index:2,children:[(0,n.jsx)(o.Z,{variant:"h6",gutterBottom:!0,children:"OAuth 账户绑定"}),(0,n.jsx)(o.Z,{color:"text.secondary",children:"OAuth绑定功能开发中..."})]})]})})}),"177827525@qq.com"===g.email&&(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{elevation:2,children:(0,n.jsxs)(j.Z,{sx:{p:3},children:[(0,n.jsx)(o.Z,{variant:"h6",gutterBottom:!0,children:"管理员功能"}),(0,n.jsx)(c.Z,{variant:"contained",onClick:()=>B.push("/admin"),children:"进入管理后台"})]})})})]})})]})]}):null}}},function(e){e.O(0,[14,886,825,197,774,888,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);